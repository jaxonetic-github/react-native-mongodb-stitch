import Subscriptions from'./subscriptions';import NativeInterface from'./nativeInterface';import DeprecatedUtils from'./deprecatedUtils';var _subscriptions=new Set();var _latestState=null;var _isListening=false;function _listenerHandler(state){var convertedState=DeprecatedUtils.convertState(state);_latestState=convertedState;_subscriptions.forEach(function(handler){return handler(convertedState);});}export function add(handler){_subscriptions.add(handler);if(_latestState){handler(_latestState);}else{NativeInterface.getCurrentState().then(function(state){_latestState=DeprecatedUtils.convertState(state);handler(_latestState);});}if(_subscriptions.size>0&&!_isListening){Subscriptions.add(_listenerHandler,false);_isListening=true;}}export function remove(handler){_subscriptions.delete(handler);if(_subscriptions.size===0&&_isListening){Subscriptions.remove(_listenerHandler);_isListening=false;}}export function clear(){_subscriptions.clear();if(_isListening){Subscriptions.remove(_listenerHandler);_isListening=false;}}export default{add:add,remove:remove,clear:clear};
//# sourceMappingURL=deprecatedSubscriptions.js.map